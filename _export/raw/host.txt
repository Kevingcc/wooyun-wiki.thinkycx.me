====== 关于服务器的host绑定的不安全因素 ======


==== 1、host主机头 ====

----
host主机头绑定是很多网站常用的一种一机多站的实现方法,相对于使用不同端口来实现一机多站要安全许多,因为端口可以通过暴力手段找到,而host绑定就要难破解很多,因为需要IP和主机名的对应.

==== 2、漏洞成因及危害 ====

----
很多网站为了方便管理和节省服务器成本,将内网管理站点和外网站点放置在同一服务器下,使用一机多站来进行隔离.

很多情况下一台服务器安装两块网卡,分别接入外网和内网,方便公网访问公开站点,内网访问管理站点.并绑定host.

例如:
<code>
xxx.com为公开站点,并且指向IP为公网网卡.
admin.xxx.com为管理站点,并且指向内网网卡.
</code>
看上去好像管理站点admin.xxx.com必须在内网才能访问但是却忽略了host绑定的问题.

但是当我们将外网IP地址强制绑定到admin.xxx.com的时候web服务器又没有做来源检查,那么我们就可以通过外网访问到本来应该只有内网才能访问的管理站点了.

并且由于是内网站点很多情况下管理员为了方便都是弱密码,或者直接未授权访问等

==== 3、漏洞的利用 ====

----

利用的话可以直接使用域名的一个暴力猜解

将外网IP和内网IP的域名全部记录下来

例如
<code>
xxx.com          ip     1.1.1.1
admin.xxx.com    ip     10.0.0.1
</code>

再使用工具将内网域名绑定到外网站点的IP上

写入hosts文件
<code>
1.1.1.1 admin.xxx.com 
</code>

即可访问到内网站点了

==== 4、漏洞案例 ====

----
[[http://www.wooyun.org/bugs/wooyun-2014-081180|途牛另类方式导致内网部分敏感系统泄露]]

[[http://www.wooyun.org/bugs/wooyun-2010-093577|盛大某游戏GM工具注入进入后台]]

[[http://www.wooyun.org/bugs/wooyun-2010-088352|傲游内网不完整漫游(大量内外网源码可被泄漏)]]

[[http://www.wooyun.org/bugs/wooyun-2010-0134151|一下科技运维不当导致内部敏感信息泄漏]]